#include "AES.h"


/*#include <iostream>
using namespace std;
#include <bitset>
typedef bitset<8> BYTE;

BYTE rc(BYTE i)
{
	unsigned char uno = 0x01;
	unsigned char due = 0x02;
	
    if(i == 0x01) return 1;
    BYTE temp = rc(i-uno);
    if(temp < 0x80) return temp * due;
    else return (due*temp) xor 0x1b;
}
01001000-
00010000=


int main()
{
    std::cout<<rc(0x01);
	
	
    return 0;
}*/


void Aes::rotWord(BYTE W[4])
{
	BYTE temp = W[0];
	W[0] = W[4];
	W[1] = W[2];
	W[3] = W[4];
	W[4] = temp;
}

void Aes::subWord(BYTE W[4])
{
	S_TABLE(W[0]);
	S_TABLE(W[1]);
	S_TABLE(W[2]);
	S_TABLE(W[3]);
}



void Aes::S_TABLE(BYTE& B)
{
	if (B == 0x00) B = 0x63;
	else if (B == 0x01) B = 0x7C;
	else if (B == 0x02) B = 0x77;
	else if (B == 0x03) B = 0x7B;
	else if (B == 0x04) B = 0xF2;
	else if (B == 0x05) B = 0x6B;
	else if (B == 0x06) B = 0x6F;
	else if (B == 0x07) B = 0xC5;
	else if (B == 0x08) B = 0x30;
	else if (B == 0x09) B = 0x01;
	else if (B == 0x0A) B = 0x67;
	else if (B == 0x0B) B = 0x2B;
	else if (B == 0x0C) B = 0xFE;
	else if (B == 0x0D) B = 0xD7;
	else if (B == 0x0E) B = 0xAB;
	else if (B == 0x0F) B = 0x76;

	else if (B == 0x10) B = 0xCA;
	else if (B == 0x11) B = 0x82;
	else if (B == 0x12) B = 0xC9;
	else if (B == 0x13) B = 0x7D;
	else if (B == 0x14) B = 0xFA;
	else if (B == 0x15) B = 0x59;
	else if (B == 0x16) B = 0x47;
	else if (B == 0x17) B = 0xF0;
	else if (B == 0x18) B = 0xAD;
	else if (B == 0x19) B = 0xD4;
	else if (B == 0x1A) B = 0xA2;
	else if (B == 0x1B) B = 0xAF;
	else if (B == 0x1C) B = 0x9C;
	else if (B == 0x1D) B = 0xA4;
	else if (B == 0x1E) B = 0x72;
	else if (B == 0x1F) B = 0xC0;

	else if (B == 0x20) B = 0xB7;
	else if (B == 0x21) B = 0xFD;
	else if (B == 0x22) B = 0x93;
	else if (B == 0x23) B = 0x26;
	else if (B == 0x24) B = 0x36;
	else if (B == 0x25) B = 0x3F;
	else if (B == 0x26) B = 0xF7;
	else if (B == 0x27) B = 0xCC;
	else if (B == 0x28) B = 0x34;
	else if (B == 0x29) B = 0xA5;
	else if (B == 0x2A) B = 0xE5;
	else if (B == 0x2B) B = 0xF1;
	else if (B == 0x2C) B = 0x71;
	else if (B == 0x2D) B = 0xD8;
	else if (B == 0x2E) B = 0x31;
	else if (B == 0x2F) B = 0x15;

	else if (B == 0x30) B = 0x04;
	else if (B == 0x31) B = 0xC7;
	else if (B == 0x32) B = 0x23;
	else if (B == 0x33) B = 0xC3;
	else if (B == 0x34) B = 0x18;
	else if (B == 0x35) B = 0x96;
	else if (B == 0x36) B = 0x05;
	else if (B == 0x37) B = 0x9A;
	else if (B == 0x38) B = 0x07;
	else if (B == 0x39) B = 0x12;
	else if (B == 0x3A) B = 0x80;
	else if (B == 0x3B) B = 0xE2;
	else if (B == 0x3C) B = 0xEB;
	else if (B == 0x3D) B = 0x27;
	else if (B == 0x3E) B = 0xB2;
	else if (B == 0x3F) B = 0x75;

	else if (B == 0x40) B = 0x09;
	else if (B == 0x41) B = 0x83;
	else if (B == 0x42) B = 0x2C;
	else if (B == 0x43) B = 0x1A;
	else if (B == 0x44) B = 0x1B;
	else if (B == 0x45) B = 0x6E;
	else if (B == 0x46) B = 0x5A;
	else if (B == 0x47) B = 0xA0;
	else if (B == 0x48) B = 0x52;
	else if (B == 0x49) B = 0x3B;
	else if (B == 0x4A) B = 0xD6;
	else if (B == 0x4B) B = 0xB3;
	else if (B == 0x4C) B = 0x29;
	else if (B == 0x4D) B = 0xE3;
	else if (B == 0x4E) B = 0x2F;
	else if (B == 0x4F) B = 0x84;

	else if (B == 0x50) B = 0x53;
	else if (B == 0x51) B = 0xD1;
	else if (B == 0x52) B = 0x00;
	else if (B == 0x53) B = 0xED;
	else if (B == 0x54) B = 0x20;
	else if (B == 0x55) B = 0xFC;
	else if (B == 0x56) B = 0xB1;
	else if (B == 0x57) B = 0x5B;
	else if (B == 0x58) B = 0x6A;
	else if (B == 0x59) B = 0xCB;
	else if (B == 0x5A) B = 0xBE;
	else if (B == 0x5B) B = 0x39;
	else if (B == 0x5C) B = 0x4A;
	else if (B == 0x5D) B = 0x4C;
	else if (B == 0x5E) B = 0x58;
	else if (B == 0x5F) B = 0xCF;

	else if (B == 0x60) B = 0xD0;
	else if (B == 0x61) B = 0xEF;
	else if (B == 0x62) B = 0xAA;
	else if (B == 0x63) B = 0xFB;
	else if (B == 0x64) B = 0x43;
	else if (B == 0x65) B = 0x4D;
	else if (B == 0x66) B = 0x33;
	else if (B == 0x67) B = 0x85;
	else if (B == 0x68) B = 0x45;
	else if (B == 0x69) B = 0xF9;
	else if (B == 0x6A) B = 0x02;
	else if (B == 0x6B) B = 0x7F;
	else if (B == 0x6C) B = 0x50;
	else if (B == 0x6D) B = 0x3C;
	else if (B == 0x6E) B = 0x9F;
	else if (B == 0x6F) B = 0xA8;

	else if (B == 0x70) B = 0x51;
	else if (B == 0x71) B = 0xA3;
	else if (B == 0x72) B = 0x40;
	else if (B == 0x73) B = 0x8F;
	else if (B == 0x74) B = 0x92;
	else if (B == 0x75) B = 0x9D;
	else if (B == 0x76) B = 0x38;
	else if (B == 0x77) B = 0xF5;
	else if (B == 0x78) B = 0xBC;
	else if (B == 0x79) B = 0xB6;
	else if (B == 0x7A) B = 0xDA;
	else if (B == 0x7B) B = 0x21;
	else if (B == 0x7C) B = 0x10;
	else if (B == 0x7D) B = 0xFF;
	else if (B == 0x7E) B = 0xF3;
	else if (B == 0x7F) B = 0xD2;

	else if (B == 0x80) B = 0xCD;
	else if (B == 0x81) B = 0x0C;
	else if (B == 0x82) B = 0x13;
	else if (B == 0x83) B = 0xEC;
	else if (B == 0x84) B = 0x5F;
	else if (B == 0x85) B = 0x97;
	else if (B == 0x86) B = 0x44;
	else if (B == 0x87) B = 0x17;
	else if (B == 0x88) B = 0xC4;
	else if (B == 0x89) B = 0xA7;
	else if (B == 0x8A) B = 0x7E;
	else if (B == 0x8B) B = 0x3D;
	else if (B == 0x8C) B = 0x64;
	else if (B == 0x8D) B = 0x5D;
	else if (B == 0x8E) B = 0x19;
	else if (B == 0x8F) B = 0x73;

	else if (B == 0x90) B = 0x60;
	else if (B == 0x91) B = 0x81;
	else if (B == 0x92) B = 0x4F;
	else if (B == 0x93) B = 0xDC;
	else if (B == 0x94) B = 0x22;
	else if (B == 0x95) B = 0x2A;
	else if (B == 0x96) B = 0x90;
	else if (B == 0x97) B = 0x88;
	else if (B == 0x98) B = 0x46;
	else if (B == 0x99) B = 0xEE;
	else if (B == 0x9A) B = 0xB8;
	else if (B == 0x9B) B = 0x14;
	else if (B == 0x9C) B = 0xDE;
	else if (B == 0x9D) B = 0x5E;
	else if (B == 0x9E) B = 0x0B;
	else if (B == 0x9F) B = 0xDB;

	else if (B == 0xA0) B = 0xE0;
	else if (B == 0xA1) B = 0x32;
	else if (B == 0xA2) B = 0x3A;
	else if (B == 0xA3) B = 0x0A;
	else if (B == 0xA4) B = 0x49;
	else if (B == 0xA5) B = 0x06;
	else if (B == 0xA6) B = 0x24;
	else if (B == 0xA7) B = 0x5C;
	else if (B == 0xA8) B = 0xC2;
	else if (B == 0xA9) B = 0xD3;
	else if (B == 0xAA) B = 0xAC;
	else if (B == 0xAB) B = 0x62;
	else if (B == 0xAC) B = 0x91;
	else if (B == 0xAD) B = 0x95;
	else if (B == 0xAE) B = 0xE4;
	else if (B == 0xAF) B = 0x79;

	else if (B == 0xB0) B = 0xE7;
	else if (B == 0xB1) B = 0xC8;
	else if (B == 0xB2) B = 0x37;
	else if (B == 0xB3) B = 0x6D;
	else if (B == 0xB4) B = 0x8D;
	else if (B == 0xB5) B = 0xD5;
	else if (B == 0xB6) B = 0x4E;
	else if (B == 0xB7) B = 0xA9;
	else if (B == 0xB8) B = 0x6C;
	else if (B == 0xB9) B = 0x56;
	else if (B == 0xBA) B = 0xF4;
	else if (B == 0xBB) B = 0xEA;
	else if (B == 0xBC) B = 0x65;
	else if (B == 0xBD) B = 0x7A;
	else if (B == 0xBE) B = 0xAE;
	else if (B == 0xBF) B = 0x08;

	else if (B == 0xC0) B = 0xBA;
	else if (B == 0xC1) B = 0x78;
	else if (B == 0xC2) B = 0x25;
	else if (B == 0xC3) B = 0x2E;
	else if (B == 0xC4) B = 0x1C;
	else if (B == 0xC5) B = 0xA6;
	else if (B == 0xC6) B = 0xB4;
	else if (B == 0xC7) B = 0xC6;
	else if (B == 0xC8) B = 0xE8;
	else if (B == 0xC9) B = 0xDD;
	else if (B == 0xCA) B = 0x74;
	else if (B == 0xCB) B = 0x1F;
	else if (B == 0xCC) B = 0x4B;
	else if (B == 0xCD) B = 0xBD;
	else if (B == 0xCE) B = 0x8B;
	else if (B == 0xCF) B = 0x8A;

	else if (B == 0xD0) B = 0x70;
	else if (B == 0xD1) B = 0x3E;
	else if (B == 0xD2) B = 0xB5;
	else if (B == 0xD3) B = 0x66;
	else if (B == 0xD4) B = 0x48;
	else if (B == 0xD5) B = 0x03;
	else if (B == 0xD6) B = 0xF6;
	else if (B == 0xD7) B = 0x0E;
	else if (B == 0xD8) B = 0x61;
	else if (B == 0xD9) B = 0x35;
	else if (B == 0xDA) B = 0x57;
	else if (B == 0xDB) B = 0xB9;
	else if (B == 0xDC) B = 0x86;
	else if (B == 0xDD) B = 0xC1;
	else if (B == 0xDE) B = 0x1D;
	else if (B == 0xDF) B = 0x9E;

	else if (B == 0xE0) B = 0xE1;
	else if (B == 0xE1) B = 0xF8;
	else if (B == 0xE2) B = 0x98;
	else if (B == 0xE3) B = 0x11;
	else if (B == 0xE4) B = 0x69;
	else if (B == 0xE5) B = 0xD9;
	else if (B == 0xE6) B = 0x8E;
	else if (B == 0xE7) B = 0x94;
	else if (B == 0xE8) B = 0x9B;
	else if (B == 0xE9) B = 0x1E;
	else if (B == 0xEA) B = 0x87;
	else if (B == 0xEB) B = 0xE9;
	else if (B == 0xEC) B = 0xCE;
	else if (B == 0xED) B = 0x55;
	else if (B == 0xEE) B = 0x28;
	else if (B == 0xEF) B = 0xDF;

	else if (B == 0xF0) B = 0x8C;
	else if (B == 0xF1) B = 0xA1;
	else if (B == 0xF2) B = 0x89;
	else if (B == 0xF3) B = 0x0D;
	else if (B == 0xF4) B = 0xBF;
	else if (B == 0xF5) B = 0xE6;
	else if (B == 0xF6) B = 0x42;
	else if (B == 0xF7) B = 0x68;
	else if (B == 0xF8) B = 0x41;
	else if (B == 0xF9) B = 0x99;
	else if (B == 0xFA) B = 0x2D;
	else if (B == 0xFB) B = 0x0F;
	else if (B == 0xFC) B = 0xB0;
	else if (B == 0xFD) B = 0x54;
	else if (B == 0xFE) B = 0xBB;
	else if (B == 0xFF) B = 0x16;
}

